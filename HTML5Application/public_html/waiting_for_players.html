<!DOCTYPE html>
<html lang="en">
    <head>

        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="">

        <title>HootHoot Web App</title>

        <!-- Bootstrap Core CSS -->
        <link href="css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom CSS -->
        <link href="css/landing-page.css" rel="stylesheet">

        <!-- Custom Fonts -->
        <link href="https://fonts.googleapis.com/css?family=Luckiest+Guy|Lobster+Two" rel="stylesheet">

        <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
        <script src="https://cdn.firebase.com/js/client/2.4.2/firebase.js"></script>
        <script src="js/load_all_js.js"></script>
    </head>
    
    <body>

        <!-- state = waiting_for_players -->
        <div class="waiting_players_page" id="waiting_for_players">

            <!-- names of player who joined the game -->
            <div class="row col-md-3 col-md-offset-1  playerContainer">
                <div class="robotoFont" style="padding-top: 2%; margin-left: 10%; font-size: 20px">
                    <p class="robotoFont" style="font-size: 50px; font-weight: 100;">Players</p>
                    
                    <!-- Get player names from firebase in waiting_for_player.js -->
                    <ul id="player_name" style="list-style: none;"></ul>
                </div>
            </div>
            
            <div>
                <div id="clockdiv" style="margin-left: 5%">
                    <div>
                        Time Remaining: <span class="seconds"></span>
                        <div class="smalltext">Seconds</div>
                    </div>
                </div>

                <!-- Station name Title -->
                <div class=" col-md-5 luckyGuyFont"> 
                    <p id="stn_name"></p>
                </div>

                <!-- Loading Gif -->
                <div class="row">
                    <div class="col-md-5">
                        <p class ="lob2Font" style="padding-left: 2%" id="state_ref"></p>
                        <iframe src="//giphy.com/embed/4AGlRfJwFDW00" width="500" height="400" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
                    </div>
                </div>
            </div>
            
            <!-- Countdown timer -->
            <script src="js/waiting_for_player.js"></script>
            <script>
                // Retrieve station name from url
                var station_name = decode_url();

                // Constants for firebase url
                var FB_stationState_url = "https://mantrodev.firebaseio.com/STATIONS/HH_" + station_name + "/state";

                // Display countdown timer if state = starting
                var ref = new Firebase(FB_stationState_url);
                ref.on("value", function(snapshot) {
                    var values = snapshot.val();
                    if (values.toString() === "starting"){
                        var deadline = new Date(Date.parse(new Date()) + 15 * 24 * 60 * 60 * 1000);
                        initializeClock('clockdiv', deadline);
                    }
                });

                // Function to get time left in countdown timer
                function getTimeRemaining(endtime) {
                    var t = Date.parse(endtime) - Date.parse(new Date());
                    var seconds = Math.floor((t / 1000) % 60);
                    return {
                      'seconds': seconds
                    };
                }

                // Function to display the clock
                function initializeClock(id, endtime) {
                    var clock = document.getElementById(id);
                    var secondsSpan = clock.querySelector('.seconds');

                    // Function to update the value inside the countdown timer
                    function updateClock() {
                        var t = getTimeRemaining(endtime);

                        secondsSpan.innerHTML = ('0' + t.seconds).slice(-2);
                        
                        // Redirect to <div id="get_ready"> when countdown timer
                        // hits 0 and state = "starting"
                        if (t.seconds <= 0) {
                            ref = new Firebase(FB_stationState_url);
                            ref.on("value", function(snapshot) {
                                var values = snapshot.val();
                                if (values.toString() === "starting"){
                                    // Clear display of <div id="waiting_for_players">
                                    document.getElementById("waiting_for_players").style.display = "none";
                                    
                                    // Make display of <div id="get_ready"> visible
                                    document.getElementById("get_ready").style.display = "block";
                                }
                                clearInterval(timeinterval);
                            });
                        }
                    }

                    // Update the countdown timer every second
                    var timeinterval = setInterval(updateClock, 1000);
                }
                
                // Decode web url to retrieve current station name
                function decode_url(){
                    var search_query = window.location.search;
                    var station = [];
                    station = search_query.split('=');
                    var station_name = station[1];
                    var decode_station = [];
                    decode_station = station_name.split('+');
                    station_name = decode_station[0] + "_" + decode_station[1];
                    window.onload = function(){
                        document.getElementById("stn_name").innerHTML = station_name;
                    };
                    return station_name;
                }
            </script>
        </div>
        <!-- end of state = waiting_for_players -->
        
        <!-- state = get_ready -->
        <!-- Display the question -->
        <div class="get_ready_page" id="get_ready" style="display:none">
            
            <!-- Question Header -->
            <div class="col-lg-12" id="qns_header">
                <h1 id="h1_qns_header">QUESTION #</h1>
            </div>
            
            <div class="col-lg-12" id="get_ready_read_qns">
                <h1 class="col-lg-11" id="h1_read_qns">Read the question before answering</h1>
                <div class="col-lg-1" id="get_ready_timer"></div>
            </div>
            
            <!-- Question Name -->
            <div class="col-lg-12" id="get_ready_qns_name">
                <h2 id="h2_qns_name">Question Name</h2>
            </div>
            
        </div>
        <!-- end of state = get_ready -->
        
        <!-- state = answering_questions -->
        <!-- Update the number of answers being answered -->
        <div class="answering_qns_page" id="answering_questions" style = "display:none">
            <div class="container-fluid" id="container">
                <div class="col-lg-12" id="qns_header">
                    <h1 id="h1_qns_header">QUESTION #</h1>
                </div>

                <div class="col-lg-11" id="answering_qns_name">
                    <h2 id="answering_h2_qns_name">Question Name</h2>
                    <img style="padding-top: 50px" src="" alt="" width="400" height="400">
                </div>

                <div class="col-lg-1" id="answering_side_column">
                    <div class="col-lg-12" id="countdown_timer"></div>
                    <h3 class="col-lg-12" id="ans_num">0 answers</h3>
                </div>

                <div class="col-lg-12">
                    <div class="row">
                        <div class="col-lg-6" id="option_1">
                            <img class="col-lg-3" src="" alt="" width="50" height="50">
                            <h3 class="col-lg-9">Option 1</h3>
                        </div>
                        <div class="col-lg-6" id="option_2">
                            <img class="col-lg-3" src="" alt="" width="50" height="50">
                            <h3 class="col-lg-9">Option 2</h3>
                        </div>
                        <div class="col-lg-6" id="option_3">
                            <img class="col-lg-3" src="" alt="" width="50" height="50">
                            <h3 class="col-lg-9">Option 3</h3>
                        </div>
                        <div class="col-lg-6" id="option_4">
                            <img class="col-lg-3" src="" alt="" width="50" height="50">
                            <h3 class="col-lg-9">Option 4</h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- end of state = answering_questions -->
        
        <!-- state = answered -->
        <!-- Show the answer statistics -->
        <div class="answered_page" id="answered" style = "display:none">
            <div class="container-fluid" id="container">
                <div class="col-lg-12" id="qns_header">
                    <h1 id="h1_qns_header">QUESTION #</h1>
                </div>
                
                <div class="col-lg-11" id="answered_qns_name">
                    <h2 id="answered_h2_qns_name">Question Name</h2>
                    <div class="row" id="answered_number">
                        <h3 class="col-lg-3">#</h3>
                        <h3 class="col-lg-3">#</h3>
                        <h3 class="col-lg-3">#</h3>
                        <h3 class="col-lg-3">#</h3>
                    </div>
                    <div class="row" id="answered_options">
                        <img class="col-lg-3" src="" alt="" width="50" height="50">
                        <img class="col-lg-3" src="" alt="" width="50" height="50">
                        <img class="col-lg-3" src="" alt="" width="50" height="50">
                        <img class="col-lg-3" src="" alt="" width="50" height="50">
                    </div>
                </div>
                
                <div class="col-lg-1" id="answered_timer">
                    <div class="col-lg-12" id="countdown_timer"></div>
                </div>
            
                <div class="col-lg-12">
                    <div class="row">
                        <div class="col-lg-6" id="option_1">
                            <img class="col-lg-3" src="" alt="" width="50" height="50">
                            <h3 class="col-lg-9">Option 1</h3>
                        </div>
                        <div class="col-lg-6" id="option_2">
                            <img class="col-lg-3" src="" alt="" width="50" height="50">
                            <h3 class="col-lg-9">Option 2</h3>
                        </div>
                        <div class="col-lg-6" id="option_3">
                            <img class="col-lg-3" src="" alt="" width="50" height="50">
                            <h3 class="col-lg-9">Option 3</h3>
                        </div>
                        <div class="col-lg-6" id="option_4">
                            <img class="col-lg-3" src="" alt="" width="50" height="50">
                            <h3 class="col-lg-9">Option 4</h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- end of state = answered -->
        
        <!-- state = leaderboard -->
        <!-- Display the top scorer statistics -->
        <div class="leaderboard_page" id="leaderboard" style = "display:none">
            <div class="container-fluid" id="container">
                <div class="col-lg-12" id="leaderboard_header">
                    <h1 id="h1_qns_header">TOP SCORER</h1>
                </div>

                <div class="col-lg-12" id="leaderboard_nickname">
                    <div class="col-lg-4 col-lg-offset-4" id="leaderboard_nickname_container">
                        <h2 id="h2_leaderboard_nickname">Nickname</h2>
                    </div>

                    <div class="col-lg-12" id="leaderboard_stats">
                        <div class="col-lg-4" id="leaderboard_points">
                            <h2># points</h2>
                        </div>

                        <div class="col-lg-4" id="leaderboard_points">
                            <h2># correct</h2>
                        </div>

                        <div class="col-lg-4" id="leaderboard_points">
                            <h2># incorrect</h2>
                        </div>
                    </div>
                </div>

                <div class="row col-lg-12">
                    <div class="col-lg-6" id="leaderboard_next_qns">
                        <h2 id="h2_leaderboard_next_qns">Next question in</h2>
                    </div>

                    <div class="col-lg-6" id="leaderboard_timer">
                        <h2 id="h2_leaderboard_timer">timer</h2>
                    </div>
                </div>
            </div>
        </div>
        <!-- end of state = leaderboard -->
        
        <!-- state = game_over -->
        <div class="game_over_page" id="game_over" style = "display:none">
            <div class="container-fluid" id="container">
                <div class="col-lg-12" id="game_over_header">
                    <h1 id="h1_qns_header">GAME OVER</h1>
                </div>

                <div class="col-lg-12" id="game_over_body">
                    <div class="col-lg-4 col-lg-offset-4" id="leaderboard_nickname_container">
                        <h2 id="h2_leaderboard_nickname">Nickname</h2>
                    </div>

                    <div class="col-lg-12" id="leaderboard_stats">
                        <div class="col-lg-4" id="leaderboard_points">
                            <h2># points</h2>
                        </div>

                        <div class="col-lg-4" id="leaderboard_points">
                            <h2># correct</h2>
                        </div>

                        <div class="col-lg-4" id="leaderboard_points">
                            <h2># incorrect</h2>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- end of state = game_over -->

        <!-- jQuery -->
        <script src="js/jquery.js"></script>

        <!-- Bootstrap Core JavaScript -->
        <script src="js/bootstrap.min.js"></script>

    </body>
</html>
    